jQuery(document).ready(function(l){"use strict";l.wp_content_pilot={init:function(){l(".wpcp-tooltip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),l(".wpcp-range-slider").ionRangeSlider({skin:"round"}),l(".wpcp-select2").select2({theme:"default wpcp-select2"}),l("#wpcp-campaign-log").insertAfter(l("#wpcp-campaign-status"))},hideKeywordField:function(){var e=l("#_keywords"),n=l("#_keyword_suggestion"),t=e.closest("p._keywords-field"),a=n.closest("p._keyword_suggestion-field");e.attr("disabled","disabled"),n.attr("disabled","disabled"),t.hide(),a.hide()},showKeywordField:function(){var e=l("#_keywords"),n=l("#_keyword_suggestion"),t=e.closest("p._keywords-field"),a=n.closest("p._keyword_suggestion-field");e.removeAttr("disabled"),n.removeAttr("disabled"),t.show(),a.show()},youtube:function(){l("#_youtube_search_type").on("change",function(){var e=l("._youtube_playlist_id-field");"global"===l(this).val()?(e.hide(),l.wp_content_pilot.showKeywordField()):(e.show(),l.wp_content_pilot.hideKeywordField())}).change()},deleteCampaignPosts:function(e){var n,t,a;e.preventDefault(),confirm("Are you sure?")&&(n=l(this),t=l(this).next(),a=n.data("campid"),e=n.data("nonce"),n.attr("disabled",!0),t.addClass("active"),n.attr("disabled",!0),t.addClass("active"),wp.ajax.send({data:{action:"wpcp_delete_all_campaign_posts",camp_id:a,nonce:e},success:function(){t.removeClass("active"),n.attr("disabled",!1),t.removeClass("active"),n.attr("disabled",!1),window.location.reload()},error:function(e){n.attr("disabled",!1),console.log(e)}}))},clearLogs:function(e){var n;e.preventDefault(),confirm("Are you sure?")&&(e=(n=l(this)).data("nonce"),wp.ajax.send({data:{action:"wpcp_clear_logs",nonce:e},success:function(){n.attr("disabled",!1),window.location.reload()},error:function(e){n.attr("disabled",!1),console.log(e)}}))},handle_manual_campaign:function(e){e.preventDefault();var n=l(this);n.hide(),n.prev(".spinner").show().addClass("is-active"),n.attr("disabled","disabled");var e=l("#wpcp-campaign-log"),t=e.find(".wpcp-campaign-log-list"),a=parseInt(n.attr("data-campaign_id"),10),o=parseInt(n.attr("data-instance"),10),i=l(".wpcp-last-article-link");function c(e){return e.message?l("<p>").addClass(e.level).html("["+e.time+"] - "+e.message):""}window.wpcp_interval,window.wpcp_logger_offset=0,window.wpcp_run_instance=o,t.html(""),e.fadeIn("slow"),e=wp.ajax.post("wpcp_run_manual_campaign",{nonce:wp_content_pilot_i10n.nonce,campaign_id:a,instance:o}),window.wpcp_interval=setInterval(function(){wp.ajax.post("wpcp_get_campaign_instance_log",{nonce:wp_content_pilot_i10n.nonce,campaign_id:a,instance:o,offset:wpcp_logger_offset}).always(function(e){window.wpcp_logger_offset+=e.length,e.length&&(e.forEach(function(e){t.append(c(e))}),t.scrollTop(t.height()))}),window.wpcp_run_instance||(clearInterval(window.wpcp_interval),window.wpcp_logger_offset=0)},500),e.always(function(e){n.removeAttr("disabled"),n.prev(".spinner").hide(),n.show(),n.attr("data-instance",Math.floor(Date.now()/1e3)),t.append(c(e)),e.link&&(i.find("a").remove(),i.append(e.link),i.find("a").addClass("wpcp-blink")),delete window.wpcp_run_instance})},polylang:function(){var e=l("._polylang_language_code-field");l("#_enable_polylang").on("change",function(){!0===l(this).prop("checked")?e.show():e.hide()}).change()}},l.wp_content_pilot.init(),l.wp_content_pilot.youtube(),l("#wpcp-delete-campaign-posts").on("click",l.wp_content_pilot.deleteCampaignPosts),l("#wpcp-clear-logs").on("click",l.wp_content_pilot.clearLogs),l("#wpcp-run-campaign").on("click",l.wp_content_pilot.handle_manual_campaign),l.wp_content_pilot.polylang()});