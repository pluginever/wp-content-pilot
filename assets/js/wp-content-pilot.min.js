/**
 * WP Content Pilot - v1.0.1 - 2018-04-12 | http://pluginever.com | Copyright (c) 2018; | Licensed GPLv2+
 */

window.Wp_Content_Pilot=function(window,document,$,undefined){"use strict";var app={init:function(){console.log("init"),app.update_template_tags(),$("#_campaign_type").on("change",app.update_template_tags),$("#wpcp-test-run").on("click",app.run_test_campaign),"Update"!==$("#publish").attr("value")&&$("#wpcp-test-run").closest(".help").html('<span style="color: red">Please publish the campaign first to start a test.</span>')},update_template_tags:function(){var campaign_type=$("#_campaign_type").val();$.post(ajaxurl,{action:"wpcp_get_template_tags",data:{type:campaign_type}},function(response){if(response.data){var tags=response.data,html="";$.each(tags,function(index,tag){html+="<code>{"+tag+"}</code>, "}),$(".wpcp-supported-tags").html(html)}})},run_test_campaign:function(e){e.preventDefault();var post_id=parseInt($("#post_ID").val()),btn=$(this);btn.attr("disabled","disabled"),btn.text("Posting....."),$.post(ajaxurl,{action:"wpcp_run_test_campaign",campaign_id:post_id,nonce:wpcp.nonce},function(response){return btn.text("Test Again"),btn.removeAttr("disabled"),!0===response.success&&void 0!==response.data.permalink&&""!==response.data.message?(!0===confirm(response.data.message)&&(btn.css("color","green"),window.open(response.data.permalink,"_blank")),!1):response.success||void 0===response.data.message||""===response.data.message?(console.log("2"),btn.css("color","red"),alert("Test Failed. Please change or add more keywords then Update and try again."),!1):(console.log("1"),btn.css("color","red"),alert(response.data.message),!1)}),console.log(post_id)}};return $(document).ready(app.init),app}(window,document,jQuery);