jQuery(document).ready((function(e){"use strict";e.wp_content_pilot={init:function(){e(".wpcp-tooltip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),e(".wpcp-range-slider").ionRangeSlider({skin:"round"}),e(".wpcp-select2").select2({theme:"default wpcp-select2"}),e("#wpcp-campaign-log").insertAfter(e("#wpcp-campaign-status"))},hideKeywordField:function(){var n=e("#_keywords"),t=e("#_keyword_suggestion"),a=n.closest("p._keywords-field"),i=t.closest("p._keyword_suggestion-field");n.attr("disabled","disabled"),t.attr("disabled","disabled"),a.hide(),i.hide()},showKeywordField:function(){var n=e("#_keywords"),t=e("#_keyword_suggestion"),a=n.closest("p._keywords-field"),i=t.closest("p._keyword_suggestion-field");n.removeAttr("disabled"),t.removeAttr("disabled"),a.show(),i.show()},youtube:function(){e("#_youtube_search_type").on("change",(function(){var n=e("._youtube_playlist_id-field");"global"===e(this).val()?(n.hide(),e.wp_content_pilot.showKeywordField()):(n.show(),e.wp_content_pilot.hideKeywordField())})).change()},deleteCampaignPosts:function(n){if(n.preventDefault(),confirm("Are you sure?")){var t=e(this),a=e(this).next(),i=t.data("campid"),o=t.data("nonce");t.attr("disabled",!0),a.addClass("active"),t.attr("disabled",!0),a.addClass("active"),wp.ajax.send({data:{action:"wpcp_delete_all_campaign_posts",camp_id:i,nonce:o},success:function(){a.removeClass("active"),t.attr("disabled",!1),a.removeClass("active"),t.attr("disabled",!1),window.location.reload()},error:function(e){t.attr("disabled",!1),console.log(e)}})}},clearLogs:function(n){if(n.preventDefault(),confirm("Are you sure?")){var t=e(this),a=t.data("nonce");wp.ajax.send({data:{action:"wpcp_clear_logs",nonce:a},success:function(){t.attr("disabled",!1),window.location.reload()},error:function(e){t.attr("disabled",!1),console.log(e)}})}},handle_manual_campaign:function(n){n.preventDefault();var t=e(this);t.hide(),t.prev(".spinner").show().addClass("is-active"),t.attr("disabled","disabled");var a,i=e("#wpcp-campaign-log"),o=i.find(".wpcp-campaign-log-list"),c=parseInt(t.attr("data-campaign_id"),10),l=parseInt(t.attr("data-instance"),10),p=e(".wpcp-last-article-link");function s(n){return n.message?e("<p>").addClass(n.level).html("["+n.time+"] - "+n.message):""}window.wpcp_interval,window.wpcp_logger_offset=0,window.wpcp_run_instance=l,o.html(""),i.fadeIn("slow"),a=wp.ajax.post("wpcp_run_manual_campaign",{nonce:wp_content_pilot_i10n.nonce,campaign_id:c,instance:l}),window.wpcp_interval=setInterval((function(){wp.ajax.post("wpcp_get_campaign_instance_log",{nonce:wp_content_pilot_i10n.nonce,campaign_id:c,instance:l,offset:wpcp_logger_offset}).always((function(e){window.wpcp_logger_offset+=e.length,e.length&&(e.forEach((function(e){o.append(s(e))})),o.scrollTop(o.height()))})),window.wpcp_run_instance||(clearInterval(window.wpcp_interval),window.wpcp_logger_offset=0)}),500),a.always((function(e){t.removeAttr("disabled"),t.prev(".spinner").hide(),t.show(),t.attr("data-instance",Math.floor(Date.now()/1e3)),o.append(s(e)),e.link&&(p.find("a").remove(),p.append(e.link),p.find("a").addClass("wpcp-blink")),delete window.wpcp_run_instance}))},polylang:function(){var n=e("._polylang_language_code-field");e("#_enable_polylang").on("change",(function(){!0===e(this).prop("checked")?n.show():n.hide()})).change()}},e.wp_content_pilot.init(),e.wp_content_pilot.youtube(),e("#wpcp-delete-campaign-posts").on("click",e.wp_content_pilot.deleteCampaignPosts),e("#wpcp-clear-logs").on("click",e.wp_content_pilot.clearLogs),e("#wpcp-run-campaign").on("click",e.wp_content_pilot.handle_manual_campaign),e.wp_content_pilot.polylang()}));